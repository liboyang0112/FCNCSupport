\section{Selection of events}
\label{sec:selection}

In the leptonic channels, the $\pt$ of the lepton is required to be 1 GeV above the trigger threshold. The leptons are required to have \texttt{Tight} ID as defined in Sec. \ref{sec:obj_reco}. %Trigger cuts can be regarded as independent and additional to these offline cuts.) is required.

In the hadronic channels, no leptons (as defined in Sec. \ref{sec:obj_reco}) should be present in the event, and the two tau candidates with the highest $\pt$ are chosen. They should also pass the \texttt{Medium} tau ID and overlap removal. To account for the trigger thresholds, the two hadronic taus are requried to pass the $\pt>40$ GeV and $\pt>30$ GeV cuts.

\subsection{Trigger}
\label{sec:trigger}

In the leptonic channels, the single-lepton triggers and di-lepton triggers are required to select the candidate events. In general, the lowest unprescaled triggers are used in every data-taking periods:

To be updated:

Single election:

2016,2017,2018:
\begin{itemize}
	\item HLT\_e26\_lhtight\_nod0\_ivarloose
	\item HLT\_e60\_lhmedium\_nod0
	\item HLT\_e140\_lhloose\_nod0
\end{itemize}
2015:
\begin{itemize}
	\item HLT\_e24\_lhmedium\_L1EM20VH
	\item HLT\_e60\_lhmedium
	\item HLT\_e120\_lhloose
\end{itemize}

Single muon:

2016,2017,2018:
\begin{itemize}
	\item HLT\_mu26\_ivarmedium
	\item HLT\_mu50
\end{itemize}
2015,2017,2018:
\begin{itemize}
	\item HLT\_mu60\_0eta105\_msonly
\end{itemize}
2015:
\begin{itemize}
	\item HLT\_mu20\_iloose\_L1MU15
	\item HLT\_mu40
\end{itemize}

Di-electron:

2018:
\begin{itemize}
	\item HLT\_2e17\_lhvloose\_nod0\_L12EM15VHI
\end{itemize}
2017,2018:
\begin{itemize}
	\item HLT\_2e24\_lhvloose\_nod0
\end{itemize}
2016:
\begin{itemize}
	\item HLT\_2e17\_lhvloose\_nod0
\end{itemize}
2015:
\begin{itemize}
	\item HLT\_2e12\_lhloose\_L12EM10VH
\end{itemize}

Di-muon:

2016,2017,2018:
\begin{itemize}
	\item HLT\_2mu14
	\item HLT\_mu22\_mu8noL1
\end{itemize}
2015:
\begin{itemize}
	\item HLT\_2mu10
	\item HLT\_mu18\_mu8noL1
\end{itemize}

Election+Muon:

2016,2017,2018:
\begin{itemize}
	\item HLT\_e17\_lhloose\_nod0\_mu14
	\item HLT\_e7\_lhmedium\_nod0\_mu24
	\item HLT\_e26\_lhmedium\_nod0(\_L1EM20VHI in 2016)\_mu8noL1
\end{itemize}
2015:
\begin{itemize}
	\item HLT\_e17\_lhloose\_mu14
	\item HLT\_e7\_lhmedium\_mu24
\end{itemize}
%\begin{description}
%\item Single-lepton triggers in 2015:
%  
%  \begin{itemize}
%  \item \texttt{HLT\_e24\_lhmedium\_L1EM20VH}, or \texttt{HLT\_e60\_lhmedium}, or \texttt{HLT\_e120\_lhloose}
%  \item \texttt{HLT\_mu20\_iloose\_L1MU15}, or \texttt{HLT\_mu50}
%  \end{itemize}
%  
%\item Single-lepton triggers in 2016:
%  
%  \begin{itemize}
%  \item \texttt{HLT\_e26\_lhtight\_nod0\_ivarloose}, or \texttt{HLT\_e60\_lhmedium\_nod0}, or \texttt{HLT\_e140\_lhloose\\\_nod0}
%  \item \texttt{HLT\_mu26\_ivarmedium}, or \texttt{HLT\_mu50}
%  \end{itemize}
%  
%\end{description}

The trigger matching between the offline and trigger level lepton objects is also required for the corresponding leptons selected for the analysis. The minimum offline lepton $p_{\text{T}}$ should be 1 GeV above the trigger threshold. For the $\tmhad$ channel in 2016, the offline muon $p_{\text{T}}$ is 2 GeV above the trigger threshold due to the trigger scale factors' binning\footnote{The trigger $\pt$ cuts on the leptons are independent of and additional to the other $\pt$ cuts introduced previously. For example, the $\pt$ cuts used in the overlap removal are still as those in Sec. \ref{sec:obj_reco}. It is also the case for the cuts introduced in the AOD derivations (Sec. \ref{sec:cuts}).}.

The trigger used for hadronic channels in each year are listed as follow:
\begin{itemize}

\item 2015: \texttt{HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo\_L1TAU20IM\_2TAU12IM}
\item 2016: \texttt{HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo}
\item 2017: \texttt{HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo\_03dR30\_L1DR\_TAU20ITAU12I\_J25}
\item 2018: \texttt{HLT\_tau35\_medium1\_tracktwoEF\_tau25\_medium1\_tracktwoEF\_03dR30\_L1DR\_TAU20ITAU12I\_J25}

 \end{itemize}

The two $\tauhad$ candidates are matched to the respective legs of the di-tau trigger using the individual single tau trigger objects. The $\pt$ thresholds are chosen such that the selected $\tauhad$ candidate $\pt$ already lies in the plateau of the respective trigger efficiency curve. Due to the rising instantaneous luminosity, the trigger used in the 2016 data taking includes a requirement for an additional level-1 calorimeter trigger jet with $\pt > \SI{25}{\GeV}$ and $|\eta|<3.2$. The leading jet in the 2016 events is required to be matched within $\Delta R < 0.4$ with the jet ROI that fulfilled the jet part of the trigger criteria (trigger jet). Figure \ref{fig:hadhad_trigger} shows the turn-on curves of the additional jet as in \cite{Htautau}, and the leading jet $\pt$ in the $\thadhad$ channel. A cut of $\pt^{\text{L1jet}} > \SI{50}{\GeV}$ is required on the trigger jet, and a leading-jet $\pt > \SI{60}{\GeV}$ cut is applied to remove the effect of turn on curve.

\subsection{Event cuts and regions}
\label{sec:cuts}

A number of event cuts are applied before getting to the signal enhanced regions with the background suppressed. Then the DAOD$\_$HIGG8D1 (DAOD$\_$HIGG4D3) derivation is feed to {\texttt ttHMultiAna} ({\texttt xTauFramework}) to produce n-tuples for analysis. The list of event-level selection criteria is as follows:

\begin{enumerate}
\item DAOD$\_$HIGG8D1 (leptonic channels) and DAOD$\_$HIGG4D3 ($\thadhad$) derivations are used for this analysis. At the derivation level, the following cuts are applied:
  \begin{itemize}


  \item In DAOD$\_$HIGG8D1, trigger skimming: all election, muon, tau triggers; Offline skimming: at least 2 light leptons or at least 1 lepton plus 1 tau.
  \item In DAOD$\_$HIGG4D3, no trigger skimming. Offline skimming: 2taus
  \end{itemize}

\item At the {\texttt xTauFramework} level, skim cuts are applied to reduce the ntuple size:
  \begin{itemize}
  \item No leptons, at least 1 medium tau and 1 loose tau, at least 3 jets with $\pt>30$ GeV, $|\eta|<4.5$ and passing either central or forward JVT cuts and with at least 1 b-tagged, pass di-tau trigger, LooseBad Event Cleaning, leading tau $\pt>40~\GeV$, sub-leading tau $\pt>30~\GeV$, two taus comes from a single vertex, leading jet $\pt>60~\GeV$, leading jet $|\eta|<3.2$, $\met>15~\GeV$. In the case of data, GRL cut as defined in Sec. \ref{sec:dataset} is also applied.
  \end{itemize}

\item At the {\texttt ttHMultiAna} level, skim cuts \cite{ATL-COM-PHYS-2018-410} are applied to reduce the ntuple size.

\item At least one primary vertex exists in the event. The primary vertex is defined as the vertex that has the largest sum of track $\pt^2$ associated to it, and has at least 4 tracks with $|z_0|<100$ mm.
\item The tau candidtes expected from Higgs decay should pass the \texttt{Medium} ID and the other quality cuts in Sec. \ref{sec:obj_reco}.
\item It is required that the tau objects are not $b$-tagged, otherwise the event is rejected.
\item Exactly one $b$-tagged jets. 
%\item Considering the di-tau are from the Higgs decay, their invariant mass should satisfy $50~\GeV<\ttvismass<130~\GeV$ and $\drtautau<3.4$ in the $\thadhad$ channel and $25~\GeV<\ttvismass<125~\GeV$ in leptonic channels.
%\item  In $l\thadhad$ channels, the lepton and b-jet are from SM top decay, so their invarian mass is expected to be smaller or around top mass: $\tlvismass<190~\GeV$.
\end{enumerate}

\input{\FCNCFigures/tex/x12fit}

The cutflow for the preselection and each channel are given in Table \ref{tab:tthML_cutflow_all} - \ref{tab:tthML_cutflow_reg1l2tau1bnj_os}.

For the TT channel tcH coupling search, the FCNC jet is from a c-quark. Regarding the similarity between the b-jet and c-jet, the very loose b-tagging is attempted on the FCNC jet in order to further select the tcH signal. However, the dominating background is $\ttbar$ where there are 2 b-jets. This resort does not help with the significance.
% as shown in the Table \ref{tab:significance_ctag}. The corresponding yield is shown in the Table \ref{tab:yield_ctag}. So it is not adopted.

%include hadhad cutflow here

\begin{table}
\label{tab:tthML_cutflow_all}
\caption{The cutflow tables for the preselection in the leptonic channels.}
\footnotesize
\input{\FCNCTables/cutflow/tthML/cutflow_all}
\end{table}


\begin{table}
\caption{The cutflow tables in the $l\tauhad$ 1j signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b1j_ss}
\end{table}
\begin{table}
\caption{The cutflow tables in the STH $\tlhad$ signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b2j_os}
\end{table}
\begin{table}
\caption{The cutflow tables in the $l\tauhad$ 2j signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b2j_ss}
\end{table}
\begin{table}
\caption{The cutflow tables in the TTH $\tlhad$ region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b3j_os}
\end{table}
\begin{table}
\label{tab:tthML_cutflow_reg1l2tau1bnj_os}
\caption{The cutflow tables in the $l\thadhad$ signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l2tau1bnj_os}
\end{table}


%\begin{table}
%\caption{The yield of the background, data and each signal after the final selection in the leptonic regions.}
%\input{\FCNCTables/tthML/raw/faketau/prefit/NOMINAL/yield_chart}
%\input{\FCNCTables/tthML/raw/fakelep/prefit/NOMINAL/yield_chart}
%\end{table}
%\begin{table}
%\caption{The significance of each signal after the final selection in the leptonic regions.}
%\input{\FCNCTables/tthML/raw/faketau/prefit/NOMINAL/significance_chart}
%\input{\FCNCTables/tthML/raw/fakelep/prefit/NOMINAL/significance_chart}
%\end{table}
%\begin{table}
%\caption{The yield of the background, data and each signal after the final selection with the loose b-tagged FCNC jet in the %leptonic regions.}
%\input{\FCNCTables/tthML/showFake/faketau/ctagfcnc/yield_chart}
%\end{table}
%\begin{table}
%\caption{The significance of each signal after the final selection with the loose b-tagged FCNC jet in the leptonic regions.}
%\input{\FCNCTables/tthML/showFake/faketau/ctagfcnc/significance_chart}
%\end{table}