\section{Selection of events}
\label{sec:selection}

In the leptonic channels, the $\pt$ of the lepton is required to be 1 GeV above the trigger threshold. The leptons are required to have \texttt{Tight} ID as defined in Sec. \ref{sec:obj_reco}. The trigger matching between the offline and trigger level lepton objects is also required for the corresponding leptons selected for the analysis.

In the hadronic channels, no leptons (as defined in Sec. \ref{sec:obj_reco}) should be present in the event, and the two tau candidates with the highest $\pt$ are chosen. They should also pass the \texttt{Medium} tau ID and overlap removal. To account for the trigger thresholds, the two hadronic taus are requried to pass the $\pt>40$ GeV and $\pt>30$ GeV cuts.

\subsection{Trigger}
\label{sec:trigger}

In the leptonic channels, the single-lepton triggers are required to select the candidate events. In general, the lowest unprescaled triggers are used in every data-taking periods:

Single election:

\begin{itemize}
\item 2015: HLT\_e24\_lhmedium\_L1EM20VH\\
HLT\_e60\_lhmedium, HLT\_e120\_lhloose
\item 2016, 2017, 2018: HLT\_e26\_lhtight\_nod0\_ivarloose\\
HLT\_e60\_lhmedium\_nod0, HLT\_e140\_lhloose\_nod0
\end{itemize}

Single muon:

\begin{itemize}
\item 2015: HLT\_mu20\_iloose\_L1MU15, HLT\_mu50
\item 2016, 2017, 2018: HLT\_mu26\_ivarmedium, HLT\_mu50
\end{itemize}

The di-lepton control regions to estimate fake taus are required to pass di-lepton triggers:

Di-electron:

\begin{itemize}
\item 2015: HLT\_2e12\_lhloose\_L12EM10VH
\item 2016: HLT\_2e17\_lhvloose\_nod0
\item 2017, 2018: HLT\_2e24\_lhvloose\_nod0
\end{itemize}

Di-muon:

\begin{itemize}
\item 2015: HLT\_mu18\_mu8noL1
\item 2016, 2017, 2018: HLT\_mu22\_mu8noL1
\end{itemize}

Election+Muon:

\begin{itemize}
\item 2015: HLT\_e17\_lhloose\_mu14
\item 2016, 2017, 2018: HLT\_e17\_lhloose\_nod0\_mu14
\end{itemize}

The trigger used for hadronic channels in each year are listed as follow:
\begin{itemize}
\small
\item 2015: HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo\_L1TAU20IM\_2TAU12IM
\item 2016: HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo
\item 2017: HLT\_tau35\_medium1\_tracktwo\_tau25\_medium1\_tracktwo\_03dR30\_L1DR\_TAU20ITAU12I\_J25
\item 2018: HLT\_tau35\_medium1\_tracktwoEF\_tau25\_medium1\_tracktwoEF\_03dR30\_L1DR\_TAU20ITAU12I\_J25

 \end{itemize}

The two $\tauhad$ candidates are matched to the respective legs of the di-tau trigger using the individual single tau trigger objects. The $\pt$ thresholds are chosen such that the selected $\tauhad$ candidate $\pt$ already lies in the plateau of the respective trigger efficiency curve. Due to the rising instantaneous luminosity, the trigger used in the 2016-2018 data taking includes a requirement for an additional level-1 calorimeter trigger jet 
%with $\pt > \SI{25}{\GeV}$ and $|\eta|<3.2$
. The leading jet in those events is required to be matched within $\Delta R < 0.4$ with the jet ROI that fulfilled the jet part of the trigger criteria (trigger jet). The $\pt > \SI{60}{\GeV}$ cut is applied to make sure that the jet is in the trigger $\pt$ plateau.
%Figure \ref{fig:hadhad_trigger} shows the turn-on curves of the additional jet as in \cite{Htautau}, and the leading jet $\pt$ in the $\thadhad$ channel. A cut of $\pt^{\text{L1jet}} > \SI{50}{\GeV}$ is required on the trigger jet, and a leading-jet $\pt > \SI{60}{\GeV}$ cut is applied to remove the effect of turn on curve.

\subsection{Event cuts}
\label{sec:cuts}

A number of event cuts are applied before getting to the signal enhanced regions with the background suppressed. Then the DAOD$\_$HIGG8D1 (DAOD$\_$HIGG4D3) derivation is feed to {\texttt ttHMultiAna} ({\texttt xTauFramework}) to produce n-tuples for analysis, where ttHMultiAna is AnalysisTop \cite{AnalysisTop} based. The list of event-level selection criteria is as follows:

\begin{enumerate}
\item DAOD$\_$HIGG8D1 (leptonic channels) and DAOD$\_$HIGG4D3 ($\thadhad$) derivations are used for this analysis. At the derivation level, the following cuts are applied:
  \begin{itemize}
  \item In DAOD$\_$HIGG8D1, trigger skimming: all election, muon, tau triggers; Offline skimming: at least 2 light leptons or at least 1 lepton plus 1 tau.
  \item In DAOD$\_$HIGG4D3, no trigger skimming. Offline skimming: 2taus
  \end{itemize}
%wmyao: define ttHML skim cuts
\item At the {\texttt ttHMultiAna} level, skim cuts in \cite{ATL-COM-PHYS-2018-410} are applied , then only the events passing either of the following cut are saved for the n-tuples:
  \begin{itemize}
  \item At least two light leptons passing loose identification criteria with leading lepton $\pt > 15$ GeV and subleading lepton $\pt > 5$ GeV within $|\eta|<2.6$.
  \item At least one light lepton passing loose identification criterua with $\pt >15$ GeV and $|\eta|<2.5$, and at least one hadronic tau. The tau lepton has to pass RNN loose requirement with $\pt >15$ GeV and $|\eta|<2.5$.
  \end{itemize}

\item At the {\texttt xTauFramework} level, skim cuts are applied to reduce the ntuple size:
  \begin{itemize}
  \item No leptons.
  \item At least 1 RNN Loose tau.
  \item At least 3 jets with $\pt>30$ GeV, $|\eta|<4.5$ and passing either central or forward JVT cuts, with at least 1 b-tagged.
  \item Taus trigger matched.
  \item LooseBad Event Cleaning.
  \item Leading tau $\pt>40~\GeV$, sub-leading tau $\pt>30~\GeV$, two taus comes from a single vertex.
  \item Leading jet $\pt>70~\GeV$, $|\eta|<3.2$
  \item $\met>15~\GeV$.
  \item In the case of data, GRL cut as defined in Sec. \ref{sec:dataset} is also applied.
  \end{itemize}

\item At least one primary vertex exists in the event. The primary vertex is defined as the vertex that has the largest sum of track $\pt^2$ associated to it, and has at least 4 tracks with $|z_0|<100$ mm.
\item The tau candidates expected from Higgs decay should pass the \texttt{Medium} ID and the other quality cuts in Sec. \ref{sec:obj_reco}.
\item It is required that the tau objects are not $b$-tagged, otherwise the event is rejected.
\item Exactly one $b$-tagged jets. 

\item kinematics cuts in Table \ref{tab:cutflow_STHhadhad} and \ref{tab:cutflow_TTHhadhad} to reduce background and provide control region for fake tau estimation.
%\item Considering the di-tau are from the Higgs decay, their invariant mass should satisfy $50~\GeV<\ttvismass<130~\GeV$ and $\drtautau<3.4$ in the $\thadhad$ channel and $25~\GeV<\ttvismass<125~\GeV$ in leptonic channels.
%\item  In $l\thadhad$ channels, the lepton and b-jet are from SM top decay, so their invarian mass is expected to be smaller or around top mass: $\tlvismass<190~\GeV$.
\end{enumerate}

\input{\FCNCFigures/tex/x12fit}

%wmyao: need to define signal regions
%Boyang: Already did in sec2.
The corresponding cutflow for the preselection and each channel are given in Table \ref{tab:xTFW_cutflow_all} - \ref{tab:tthML_cutflow_reg1l2tau1bnj_os}.

For the TT channel tcH coupling search, the FCNC jet is from a c-quark. Regarding the similarity between the b-jet and c-jet, the very loose b-tagging is attempted on the FCNC jet in order to further select the tcH signal. However, the dominating background is $\ttbar$ where there are 2 b-jets. This resort does not help with the significance.
% as shown in the Table \ref{tab:significance_ctag}. The corresponding yield is shown in the Table \ref{tab:yield_ctag}. So it is not adopted.

%include hadhad cutflow here
\begin{table}
\caption{The cutflow tables for the preselection in the hadronic channels.}
\label{tab:xTFW_cutflow_all}
\footnotesize
\input{\FCNCTables/cutflow/xTFW/cutflow_all}
\end{table}

\begin{table}
\caption{The cutflow tables in the STH $\thadhad$ signal region.}
\label{tab:cutflow_STHhadhad}
\input{\FCNCTables/cutflow/xTFW/cutflow_reg2mtau1b2jos}
\end{table}

\begin{table}
\caption{The cutflow tables in the TTH $\thadhad$ signal region.}
\label{tab:cutflow_TTHhadhad}
\input{\FCNCTables/cutflow/xTFW/cutflow_reg2mtau1b3jos}
\end{table}

\begin{table}
\caption{The cutflow tables for the preselection in the leptonic channels.}
\label{tab:tthML_cutflow_all}
\footnotesize
\input{\FCNCTables/cutflow/tthML/cutflow_all}
\end{table}


\begin{table}
\caption{The cutflow tables in the $l\tauhad$ 1j signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b1j_ss}
\end{table}
\begin{table}
\caption{The cutflow tables in the STH $\tlhad$ signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b2j_os}
\end{table}
\begin{table}
\caption{The cutflow tables in the $l\tauhad$ 2j signal region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b2j_ss}
\end{table}
\begin{table}
\caption{The cutflow tables in the TTH $\tlhad$ region.}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l1tau1b3j_os}
\end{table}
\begin{table}
\caption{The cutflow tables in the $l\thadhad$ signal region.}
\label{tab:tthML_cutflow_reg1l2tau1bnj_os}
\input{\FCNCTables/cutflow/tthML/cutflow_reg1l2tau1bnj_os}
\end{table}
