\section{MVA analysis}
\label{sec:mva}

In this section, we investigate the sensitivity of probing signal using one of the Multi-Variate Analysis (MVA) methods, the Gradient Boosted Decision Trees (BDT) method~\cite{BDT,BDT2}, with the {\texttt TMVA} software package. The BDT output score is in the range between -1 and 1. The most signal-like events have scores near 1 while the most background-like events have scores near -1.

The signal topology and kinematics are different across all the channels. To maximize the overall sensitivity, separated BDTG trainings are applied to each the signal region. A number of variables as the BDT inputs are used to train and test events in each signal region for maximal signal acceptance and background rejection. They are listed in Tab.~\ref{tab:importance_tthML} and Tab.~\ref{tab:importance_xTFW}. The most sensitive variables distributions are shown in Fig. \ref{fig:mva_input_hadhad}-\ref{fig:mva_input_lhadhad}

\begin{table}
\caption{The importance (in \%) of each variables used in the BDTG training for leptonic channels, the two numbers in the each block are from the two training folds.}
\label{tab:importance_tthML}
\input{\FCNCTables/Importance/tthML/Merged}
\end{table}


\begin{table}
\caption{The importance (in \%) of each variables used in the BDTG training for hadronic channels, the two numbers in the each block are from the two training folds.}
\label{tab:importance_xTFW}
\input{\FCNCTables/Importance/xTFW/Merged}
\end{table}

The signal and background samples are randomly divided into two equal parts (denoted as even and odd parity events). The BDT is trained with one part, and tested on the other part. It is always ensured that the BDT derived from the training events is not applied to the same events, but only to the independent test ones. The sum of MC all background processes, corrected normalized, are used in the training and testing. %The Gradient BDT parameters used are listed in Tab. \ref{tab:bdt_pars}. 
With the \texttt{IgnoreNegWeightsInTraining} option, only MC events with positive MC weights are used in the traning. The comparison of BDT performances in test-odd and test-even samples is given in Fig. \ref{fig:overtrain_hadhad}-\ref{fig:overtrain_lhadhad}. The BDT parameters \texttt{NTrees} and \texttt{nCuts} are tuned such that the test-odd and test-even agrees, and the signal sensitivity is optimised.

The importance factors\footnote{
The importance is evaluated as the total separation gain that this variable had in the decision trees (weighted by the number of events). It is normalized to all variables together, which have an importance of 1.
}
of different variables used in the training is listed in Tab. \ref{tab:importance}. The two numbers in each block represent the importance factor of the two models trained from even and odd parts. The consistency of these factors implies that the training models are stable.


\input{\FCNCFigures/tex/BDTinput}

As a cross check, the comparisons between BDT distributions in testing samples, as well as the test even and test odd ROC curves, are shown in Fig. \ref{fig:overtrain_hadhad} and \ref{fig:overtrain_lephad}.

\input{\FCNCFigures/tex/BDT}

The final yield and stats only significance is shown in Table \ref{tab:yield} and Table \ref{tab:significance}

\begin{table}
\caption{The yield of the background, data and each signal before the final fit.}
\label{tab:yield}
%\input{\FCNCTables/hadhad_yield_chart}
\input{\FCNCTables/tthML/showFake/faketau/postfit/NOMINAL/yield_chart}
%\input{\FCNCTables/tthML/showFake/fakelep/postfit/NOMINAL/yield_chart}
\end{table}

\begin{table}
\caption{The stat. only significance of signal before the final fit.}
\label{tab:significance}
%\input{\FCNCTables/hadhad_significance_chart}
\input{\FCNCTables/tthML/showFake/faketau/postfit/NOMINAL/significance_chart}
%\input{\FCNCTables/tthML/showFake/fakelep/postfit/NOMINAL/significance_chart}
\end{table}


\begin{table}
\caption{The yield of the background, data and each signal before the final fit.}
\label{tab:yield}
%\input{\FCNCTables/hadhad_yield_chart}
\input{\FCNCTables/xTFW/showFake/NOMINAL/yield_chart}
%\input{\FCNCTables/tthML/showFake/fakelep/postfit/NOMINAL/yield_chart}
\end{table}

\begin{table}
\caption{The stat. only significance of signal before the final fit.}
\label{tab:significance}
%\input{\FCNCTables/hadhad_significance_chart}
\input{\FCNCTables/xTFW/showFake/NOMINAL/significance_chart}
%\input{\FCNCTables/tthML/showFake/fakelep/postfit/NOMINAL/significance_chart}
\end{table}



